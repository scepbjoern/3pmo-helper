# 3PMo Helper

Webâ€‘App fÃ¼r das 3PMoâ€‘Modul (Prozessmodellierung). Sie bÃ¼ndelt aktuell zwei Werkzeuge:

- StudentQuizâ€‘Bewertung (inkl. Extraktion aus StudentQuiz- und Ranglisteâ€‘Reiter)
- Studierendenâ€‘Themenzuteilung (Excelâ€‘Upload â†’ balancierte Zuteilung â†’ Excel)

Die App ist vollstÃ¤ndig clientseitig, benÃ¶tigt keinen Server und kann einfach durch Ã–ffnen der `index.html` genutzt werden.

## ğŸ¥ Videoâ€‘Tutorials
- â–¶ï¸ How to use, install, and build the app with Windsurf AI: https://youtu.be/ICW7BqLz2B8
- â–¶ï¸ 3PMo Helper â€“ Studierendenâ€‘Themenzuteilung: https://youtu.be/E9MqgW1tyAA

## Features

<!-- Ehemalige 'StudentQuizâ€‘Extraktor' Sektion entfernt; Extraktion ist Teil von 'StudentQuizâ€‘Bewertung'. -->

### StudentQuizâ€‘Bewertung
- Kombination der extrahierten Daten aus Bereich 2 (StudentQuiz) und Bereich 3 (Rangliste)
- Automatische Bewertung je Studierende/n gemÃ¤ÃŸ Gewichtung 50/25/25 (siehe Abschnitt â€Hinweise zur Bewertungâ€œ in der App)
- ZusÃ¤tzliche AbzÃ¼ge: falscher Frageblock (âˆ’20), mehr falsche als richtige Antworten (âˆ’10)
- Markierung â€Manuell zu bewertenâ€œ, wenn definierte Kriterien zutreffen (z. B. Rating < 4, wenig Kommentare, etc.)
- Direkte Bearbeitung in der Tabelle: `Bew. man.` und `BegrÃ¼ndung` sind editierbar; ZeilenumbrÃ¼che in BegrÃ¼ndungen werden unterstÃ¼tzt
- â€Nur manuell zu Bewertende anzeigenâ€œ Filter und Sortierfunktionen pro Spalte
- Excelâ€‘Export mit Formatierung (Gitternetzlinien via Zellrahmen, Textumbruch in Spalte BegrÃ¼ndung, vertikale Ausrichtung oben)
- Export filtert EintrÃ¤ge mit `KÃ¼rzel = '-'` automatisch heraus und sortiert nach KÃ¼rzel
- Extraktion in Bereich 2: Felder `questionname`, `creatorname`, `difficultylevel` (aus `data-difficultylevel`), `rate` (aus `data-rate`), `comments` (`n.a.` â†’ 0)
- Extraktion in Bereich 3: Felder `student_name`, `published_question_points`, `rating_points`, `correct_answers_points`, `false_answers_points`
- Optional: Export der reinen Extraktionsdaten (Bereich 2/3) als Excel, CSVâ€‘Fallback

### Studierendenâ€‘Themenzuteilung
- Excelâ€‘Upload mit den Spalten â€Kuerzelâ€œ, â€Klasseâ€œ (weitere Spalten werden ignoriert)
- Eingabefelder: Testnummer (1â€“12), BlÃ¶cke (Semikolonâ€‘getrennt)
- BlÃ¶ckeâ€‘Format: `Semesterwoche_Folienbereich`, z.â€¯B. `1_8-12; 1_13-17; 2_2-6`
- Zuteilungslogik (klassenweise, balanciert):
  - Jede/r Studierende erhÃ¤lt 1 Block zum Erstellen der Frage
  - ZusÃ¤tzlich 2 verschiedene BlÃ¶cke zum Beantworten (beide â‰  Erstellâ€‘Block)
  - GleichmÃ¤ÃŸige Verteilung Ã¼ber alle BlÃ¶cke innerhalb der Klasse
- Zusammenfassung vor der Vorschau:
  - Gesamtsicht je Block (Anzahl â€Erstellenâ€œ/â€Beantwortenâ€œ)
  - Pro Klasse dieselbe Ãœbersicht
  - Mit Totalâ€‘Zeile
- Export als Excel mit AutoFilter und breiten Spalten C/D
  - Dateiname: `3PMo_Zuteilung_TestNN.xlsx` (NN zweistellig)

## Ordnerstruktur
- `index.html` â€“ UI mit Tabs (Bewertung/Zuteilung) und Scriptâ€‘Einbindung
- `script.js` â€“ Parsing, Extraktion, Zuteilung, Vorschau, Exporte
- `styles.css` â€“ Styles (Tabs, Tabellen, Summary)
- `vendor/xlsx.bundle.js` â€“ eingebundene SheetJSâ€‘Bibliothek (fÃ¼r XLSXâ€‘Export)
- `vendor/xlsx.full.min.js` â€“ alternative/zusÃ¤tzliche Distribution von SheetJS

## Quick Start
- `index.html` im Browser Ã¶ffnen (Doppelklick)
- Optional lokaler Server:
  - Python:
    ```powershell
    python -m http.server 5500
    ```
    â†’ http://127.0.0.1:5500
  - Node (eine Option):
    ```powershell
    npx http-server -p 5500
    ```

## Nutzung

<!-- Ehemalige 'StudentQuizâ€‘Extraktor' Nutzungssektion entfernt; die Extraktion erfolgt in den Bereichen 2 und 3 des Bewertungstabs. -->

### StudentQuizâ€‘Bewertung
1. In Bereich 1 einen Test anlegen oder laden (Name angeben)
2. Optional: â€Studierendenâ€‘Hilfstabelleâ€œ hochladen (global gespeichert)
3. Optional: â€Zuteilungstabelle fÃ¼r aktuellen Testâ€œ laden (testspezifisch gespeichert)
4. Bereich 2: StudentQuizâ€‘HTML einfÃ¼gen und extrahieren
5. Bereich 3: Ranglistenâ€‘HTML einfÃ¼gen und extrahieren
6. Bereich 4: â€Bewertungen generierenâ€œ klicken, anschlieÃŸend bei Bedarf `Bew. man.` und `BegrÃ¼ndung` bearbeiten
7. Optional: â€Nur manuell zu Bewertende anzeigenâ€œ aktivieren
8. â€Bewertungen als Excel herunterladenâ€œ

### Studierendenâ€‘Themenzuteilung
1. Excel â€Kuerzel/Klasseâ€œ hochladen (erstes Tabellenblatt wird gelesen)
2. Testnummer (1â€“12) eintragen
3. BlÃ¶cke als Semikolonâ€‘Liste eingeben, z.â€¯B. `1_8-12; 1_13-17; 2_2-6`
4. â€Zuteilen & Vorschauâ€œ klicken: Vorschau + Zusammenfassungen
5. â€Als Excel herunterladenâ€œ speichert `3PMo_Zuteilung_TestNN.xlsx`
6. Optional: â€Template herunterladenâ€œ erzeugt ein Excel mit den Kopfzeilen â€Kuerzelâ€œ, â€Klasseâ€œ

## Excelâ€‘Export (SheetJS)
Die App nutzt SheetJS (in dieser App per `vendor/xlsx.bundle.js` eingebunden). Falls XLSX nicht verfÃ¼gbar ist, wird automatisch eine CSV erzeugt.

Formatierung im Bewertungsâ€‘Export:
- Gitternetzlinien (dÃ¼nne Zellrahmen) fÃ¼r Kopfâ€‘ und Datenzeilen
- Spalte â€BegrÃ¼ndungâ€œ: kleinerer Font, Textumbruch aktiv, vertikale Ausrichtung oben
- Alle Zellen: vertikale Ausrichtung oben
- Zeilen mit `KÃ¼rzel = '-'` werden nicht exportiert

MÃ¶gliche Downloadâ€‘Quellen fÃ¼r SheetJS:
- https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js
- https://unpkg.com/xlsx@0.19.3/dist/xlsx.full.min.js
- https://raw.githubusercontent.com/SheetJS/sheetjs/v0.19.3/dist/xlsx.full.min.js

## Grenzen
- Extraktion: funktioniert, solange die HTMLâ€‘Struktur (Klassen/Attribute) der StudentQuizâ€‘Tabelle beibehalten wird
- `n.a.` wird als 0 gezÃ¤hlt; andere Lokalisierungen kÃ¶nnen Anpassungen erfordern

## Datenschutz
Alle Daten bleiben lokal im Browser (LocalStorage). Es findet keine Serverâ€‘Verarbeitung statt.

Persistenz (Ãœberblick):
- Pro Test gespeichert: eingegebene HTMLâ€‘Extrakte (StudentQuiz/Rangliste), manuelle Bewertungen/BegrÃ¼ndungen, Markierung â€manuell zu bewertenâ€œ, Zuteilungstabelle
- Global gespeichert: â€Studierendenâ€‘Hilfstabelleâ€œ, TabellenhÃ¶heâ€‘Einstellung fÃ¼r Bereich 4
- â€Test lÃ¶schenâ€œ entfernt alle Daten des aktuellen Tests (die globale Hilfstabelle bleibt erhalten)
â€“ Export/Import (JSON) enthÃ¤lt: manuelle Noten, BegrÃ¼ndungen, â€manuell zu bewertenâ€œ-Markierung
