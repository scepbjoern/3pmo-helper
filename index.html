<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3PMo Helper</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="vendor/xlsx.bundle.js"></script>
  <script src="grading.js"></script>
  <script src="persistence.js"></script>
  <script defer src="script.js"></script>
</head>
<body>
  <div class="container">
    <h1>3PMo Helper</h1>

    <div class="tabs">
      <button id="tabSQ" class="tab active" type="button">StudentQuiz-Bewertung</button>
      <button id="tabAssign" class="tab" type="button">Studierenden-Themenzuteilung</button>
    </div>

    <section id="page-sq" class="page active" aria-labelledby="tabSQ">
      
      <!-- Bereich 1: Ãœbersicht & Test-Verwaltung -->
      <details class="wizard-section" open>
        <summary><h2>1. Ãœbersicht & Test-Verwaltung</h2></summary>
        <div class="wizard-content">
          <p class="hint">Willkommen beim StudentQuiz-Bewertungs-Wizard. Folgen Sie diesen Schritten:</p>
          <ol>
            <li><strong>Test auswÃ¤hlen/anlegen:</strong> WÃ¤hlen Sie einen bestehenden Test oder legen Sie einen neuen an. <em>Zwischen Tests wechseln:</em> Testnamen eingeben und â€Test ladenâ€œ klicken. â€Neuer Testâ€œ erstellt einen neuen Test.</li>
            <li><strong>Studierendenâ€‘Hilfstabelle hochladen:</strong> Global gespeichert; gilt fÃ¼r alle Tests.</li>
            <li><strong>Zuteilungstabelle fÃ¼r den aktuellen Test laden:</strong> Testspezifisch gespeichert.</li>
            <li><strong>StudentQuizâ€‘Tabelle extrahieren:</strong> Kopieren Sie die HTMLâ€‘Tabelle aus dem Reiter "StudentQuiz" der Moodleâ€‘AktivitÃ¤t und extrahieren Sie die relevanten Fragendaten.</li>
            <li><strong>Ranglisteâ€‘Tabelle extrahieren:</strong> Kopieren Sie die HTMLâ€‘Tabelle aus dem Reiter "Rangliste" der Moodleâ€‘AktivitÃ¤t und extrahieren Sie die Studierendenleistungen.</li>
            <li><strong>Bewertungen:</strong> Automatische Bewertung wird berechnet. Sie kÃ¶nnen manuelle Anpassungen und BegrÃ¼ndungen direkt in der Tabelle eingeben (werden automatisch gespeichert).</li>
            <li><strong>Export:</strong> Laden Sie die finalen Bewertungen als Excelâ€‘Datei herunter.</li>
          </ol>

          <div class="test-management">
            <h3>Test-Verwaltung</h3>
            
            <label for="testNameInput" class="label">Testname</label>
            <input type="text" id="testNameInput" placeholder="z.B. Test 1, HS2024, etc." />
            
            <div class="buttons">
              <button id="btnNewTest" type="button" class="primary">Neuer Test</button>
              <button id="btnLoadTest" type="button">Test laden</button>
              <button id="btnSaveTest" type="button" class="success">Test exportieren (JSON)</button>
              <button id="btnImportTest" type="button">Test importieren (JSON)</button>
              <button id="btnDeleteTest" type="button" style="background: #ef4444; border-color: #dc2626; color: white;">Test lÃ¶schen</button>
            </div>
            <input type="file" id="testFileInput" accept=".json" style="display: none;" />
            
            <div id="testStatus" class="status" role="status" aria-live="polite"></div>
            
            <details class="note">
              <summary>Hinweis zur Datenspeicherung</summary>
              <ul>
                <li><strong>Automatisches Speichern:</strong> Manuelle Bewertungen, BegrÃ¼ndungen und â€Manuell zu bewertenâ€œ werden <em>pro Test</em> lokal (LocalStorage) gespeichert.</li>
                <li><strong>Hilfstabellen:</strong> Die Studierendenâ€‘Hilfstabelle wird <em>global</em> gespeichert (gilt fÃ¼r alle Tests).</li>
                <li><strong>Zuteilung:</strong> Die Zuteilungstabelle wird <em>testspezifisch</em> gespeichert.</li>
                <li><strong>HTMLâ€‘Daten:</strong> Die in Bereich 2/3 eingefÃ¼gten HTMLâ€‘Daten werden <em>pro Test</em> gespeichert und kÃ¶nnen mit â€Gespeicherte Daten lÃ¶schenâ€œ in den jeweiligen Bereichen entfernt werden.</li>
                <li><strong>Export/Import (JSON):</strong> EnthÃ¤lt manuelle Noten, BegrÃ¼ndungen sowie die Markierung â€Manuell zu bewertenâ€œ.</li>
                <li><strong>Test lÃ¶schen:</strong> Entfernt alle Daten des aktuellen Tests aus dem LocalStorage. Die globale Studierendenâ€‘Hilfstabelle bleibt erhalten.</li>
                <li><strong>Mehrere Tests:</strong> Sie kÃ¶nnen verschiedene Tests parallel verwalten (z.â€¯B. â€Test 1â€œ, â€Test 2â€œ). <em>Wechsel:</em> Testnamen eingeben und â€Test ladenâ€œ klicken. â€Neuer Testâ€œ erstellt einen neuen Test.</li>
              </ul>
            </details>
          </div>

          <div class="helper-tables" style="margin-top: 24px;">
            <h3>Hilfstabellen fÃ¼r Validierung</h3>
            
            <div class="upload-section">
              <label>
                <strong>Studierenden-Hilfstabelle</strong> (KÃ¼rzel â†’ Vorname Nachname):
              </label>
              <input type="file" id="studentHelperFile" accept=".xlsx,.xls">
              <div class="buttons">
                <button id="btnUploadStudentHelper" type="button" class="primary">Hochladen</button>
                <button id="btnClearStudentHelper" type="button" class="secondary" style="display: none;">Daten lÃ¶schen</button>
              </div>
              <div id="statusStudentHelper" class="status"></div>
            </div>

            <div class="upload-section" style="margin-top: 16px;">
              <label>
                <strong>Zuteilungstabelle fÃ¼r aktuellen Test</strong> (aus Tab "Studierenden-Themenzuteilung"):
              </label>
              <input type="file" id="assignmentFile" accept=".xlsx,.xls">
              <div class="buttons">
                <button id="btnUploadAssignment" type="button" class="primary">Hochladen</button>
                <button id="btnClearAssignment" type="button" class="secondary" style="display: none;">Daten lÃ¶schen</button>
              </div>
              <div id="statusAssignment" class="status"></div>
            </div>
          </div>
        </div>
      </details>

      <!-- Bereich 2: StudentQuiz-Tabelle extrahieren -->
      <details class="wizard-section" open>
        <summary><h2>2. StudentQuiz-Tabelle extrahieren</h2></summary>
        <div class="wizard-content">
          <p class="hint">FÃ¼gen Sie unten HTML mit der Tabelle aus dem Reiter "StudentQuiz" einer Moodle-AktivitÃ¤t "StudentQuiz" ein. Extrahiert werden: <strong>questionname</strong>, <strong>creatorname</strong>, <strong>difficultylevel</strong>, <strong>rate</strong>, <strong>comments</strong>. Danach kÃ¶nnen Sie die Daten als Excel herunterladen.</p>

          <label for="htmlInput" class="label">HTML-Eingabe</label>
          <textarea id="htmlInput" placeholder="Hier HTML-Code einfÃ¼gen..."></textarea>

          <div class="buttons">
            <button id="btnParse" type="button" class="primary">Extrahieren & Vorschau</button>
            <button id="btnDownload" type="button" class="success">Als Excel herunterladen</button>
            <button id="btnClearSavedHtml" type="button" class="secondary" style="display: none;">Gespeicherte Daten lÃ¶schen</button>
          </div>

          <div id="status" class="status" role="status" aria-live="polite"></div>

          <div class="table-wrapper">
            <table id="previewTable">
              <thead>
                <tr>
                  <th>âœï¸</th>
                  <th>ğŸ”</th>
                  <th>questionname</th>
                  <th>creatorname</th>
                  <th>difficultylevel</th>
                  <th>rate</th>
                  <th>comments</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <details class="note">
            <summary>Hinweis zur Extraktion</summary>
            <ul>
              <li><strong>difficultylevel</strong> wird nur aus <code>data-difficultylevel</code> gelesen. Falls nicht vorhanden, bleibt das Feld leer.</li>
              <li><strong>rate</strong> wird nur aus <code>data-rate</code> gelesen. Falls nicht vorhanden, bleibt das Feld leer.</li>
              <li><strong>comments</strong>: "n.a." wird als 0 gezÃ¤hlt.</li>
              <li><strong>Speicherung:</strong> Das eingegebene HTML wird <em>pro Test</em> im Browser gespeichert. Mit â€Gespeicherte Daten lÃ¶schenâ€œ kÃ¶nnen Sie es entfernen.</li>
            </ul>
          </details>
        </div>
      </details>

      <!-- Bereich 3: Rangliste-Tabelle extrahieren -->
      <details class="wizard-section" open>
        <summary><h2>3. Rangliste-Tabelle extrahieren</h2></summary>
        <div class="wizard-content">
          <p class="hint">FÃ¼gen Sie unten HTML mit der Tabelle aus dem Reiter "Rangliste" einer Moodle-AktivitÃ¤t "StudentQuiz" ein. Extrahiert werden: <strong>student_name</strong>, <strong>published_question_points</strong>, <strong>rating_points</strong>, <strong>correct_answers_points</strong>, <strong>false_answers_points</strong>. Danach kÃ¶nnen Sie die Daten als Excel herunterladen.</p>

          <label for="htmlInputRanking" class="label">HTML-Eingabe</label>
          <textarea id="htmlInputRanking" placeholder="Hier HTML-Code einfÃ¼gen..."></textarea>

          <div class="buttons">
            <button id="btnParseRanking" type="button" class="primary">Extrahieren & Vorschau</button>
            <button id="btnDownloadRanking" type="button" class="success">Als Excel herunterladen</button>
            <button id="btnClearSavedRankingHtml" type="button" class="secondary" style="display: none;">Gespeicherte Daten lÃ¶schen</button>
          </div>

          <div id="statusRanking" class="status" role="status" aria-live="polite"></div>

          <div class="table-wrapper">
            <table id="previewTableRanking">
              <thead>
                <tr>
                  <th>student_name</th>
                  <th>published_question_points</th>
                  <th>rating_points</th>
                  <th>correct_answers_points</th>
                  <th>false_answers_points</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <details class="note">
            <summary>Hinweis zur Extraktion</summary>
            <ul>
              <li>Die Extraktion erfolgt analog zur StudentQuiz-Tabelle.</li>
              <li>Punktwerte werden als numerische Werte extrahiert.</li>
              <li><strong>Speicherung:</strong> Das eingegebene HTML wird <em>pro Test</em> im Browser gespeichert. Mit â€Gespeicherte Daten lÃ¶schenâ€œ kÃ¶nnen Sie es entfernen.</li>
            </ul>
          </details>
        </div>
      </details>

      <!-- Bereich 4: Bewertungen -->
      <details class="wizard-section" open>
        <summary><h2>4. Bewertungen</h2></summary>
        <div class="wizard-content">
          <p class="hint">In diesem Bereich werden basierend auf den extrahierten Daten aus den Bereichen 2 und 3 automatisch Bewertungen fÃ¼r die Studierenden berechnet. Sie kÃ¶nnen die automatisch generierten Bewertungen manuell Ã¼berschreiben und BegrÃ¼ndungen hinzufÃ¼gen. Am Ende kÃ¶nnen Sie die finalen Bewertungen als Excel-Datei exportieren.</p>
          
          <div class="buttons">
            <button id="btnGenerateGrades" type="button" class="primary" disabled>Bewertungen generieren</button>
            <button id="btnDownloadGrades" type="button" class="success" disabled>Bewertungen als Excel herunterladen</button>
            <button id="btnCopyStudentGuide" type="button" class="secondary">Studierendenanleitung in Zwischenablage kopieren</button>
          </div>

          <!-- Bonus-Filter-Konfiguration -->
          <div id="bonusFilterConfig" style="display: none; margin-top: 15px; padding: 15px; border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9;">
            <h4 style="margin-top: 0;">Bonus-Filter Konfiguration</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 10px;">
              <div>
                <label for="filterMinTotalGrade">Min. Bewertung total (%):</label>
                <input type="number" id="filterMinTotalGrade" min="0" max="100" step="1" value="90" style="width: 100%; padding: 5px;">
              </div>
              <div>
                <label for="filterMinRating">Min. Erhaltene Bewertung:</label>
                <input type="number" id="filterMinRating" min="0" max="5" step="0.1" value="4.5" lang="en" style="width: 100%; padding: 5px;">
              </div>
              <div>
                <label for="filterMinComments">Min. Anzahl Kommentare:</label>
                <input type="number" id="filterMinComments" min="0" step="1" value="3" style="width: 100%; padding: 5px;">
              </div>
              <div>
                <label for="filterMinDifficulty">Min. Ã˜ Schwierigkeitsgrad:</label>
                <input type="number" id="filterMinDifficulty" min="0" max="1" step="0.01" value="0.4" lang="en" style="width: 100%; padding: 5px;">
              </div>
              <div>
                <label for="filterMaxDifficulty">Max. Ã˜ Schwierigkeitsgrad:</label>
                <input type="number" id="filterMaxDifficulty" min="0" max="1" step="0.01" value="0.6" lang="en" style="width: 100%; padding: 5px;">
              </div>
            </div>
            <div style="margin-top: 15px;">
              <button id="btnApplyBonusFilter" type="button" class="primary">Bonus-Filter anwenden</button>
            </div>
            <p style="margin-top: 10px; font-size: 0.9em; color: #666;"><strong>Hinweis:</strong> Klicken Sie auf die SchaltflÃ¤che, um Fragen zu markieren, die die Filter-Kriterien erfÃ¼llen. Markierte Fragen (0, 1, 2) bleiben bei erneutem Filtern erhalten.</p>
          </div>

          <!-- Checkbox fÃ¼r Export der Bonus-Spalte -->
          <div id="exportBonusOption" style="display: none; margin-top: 10px;">
            <label>
              <input type="checkbox" id="chkExportBonus">
              Bonus-Spalte in Excel exportieren
            </label>
          </div>

          <div id="statusGrades" class="status" role="status" aria-live="polite"></div>

          <div class="buttons" id="gradeFilterButtons" style="display: none;">
            <button id="btnFilterManual" type="button">Nur manuell zu Bewertende anzeigen</button>
            <button id="btnFilterBonusQuestions" type="button">Mit Bonus ? markierte anzeigen</button>
            <button id="btnShowAll" type="button">Alle anzeigen</button>
          </div>

          <div class="table-height-control" id="tableHeightControl" style="display: none;">
            <label for="tableHeightSlider">TabellenhÃ¶he: <span id="tableHeightValue">600</span>px</label>
            <input type="range" id="tableHeightSlider" min="300" max="1200" value="600" step="50">
          </div>

          <div class="table-wrapper" id="gradesTableWrapper">
            <table id="gradesTable">
              <thead>
                <tr>
                  <th>Man.</th>
                  <th>âœï¸</th>
                  <th>ğŸ”</th>
                  <th class="sortable" data-sort="student_name" data-order="asc">Student â–²</th>
                  <th class="sortable" data-sort="bonus">Bonus</th>
                  <th class="sortable" data-sort="total_grade">Bew. tot.</th>
                  <th class="sortable" data-sort="automatic_grade">Bew. aut.</th>
                  <th class="sortable" data-sort="manual_grade">Bew. man.</th>
                  <th>BegrÃ¼ndung</th>
                  <th class="sortable" data-sort="question_count">Fragen erstellt</th>
                  <th class="sortable" data-sort="rating_points">Erhaltene Bewertung</th>
                  <th class="sortable" data-sort="total_comments">Î£ Komm.</th>
                  <th class="sortable" data-sort="avg_difficultylevel">Ã˜ Schw.</th>
                  <th class="sortable" data-sort="wrong_block">Falscher Frageblock</th>
                  <th class="sortable" data-sort="total_answers_points">Beantw./Bew. Fragen</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <details class="note">
            <summary>Hinweise zu den Spalten</summary>
            <ul>
              <li><strong>Man.:</strong> Checkbox â€Manuell zu bewerten". Aktiviert/Deaktiviert die Markierung und Filterbarkeit.</li>
              <li><strong>âœï¸ / ğŸ”:</strong> Direktlinks zum Bearbeiten bzw. zur Vorschau der Frage (falls vorhanden).</li>
              <li><strong>Student:</strong> Anzeigename der/des Studierenden. EintrÃ¤ge, die â€Manuell zu bewerten" sind, werden hervorgehoben.</li>
              <li><strong>Bonus:</strong> Markierung fÃ¼r besonders gute Fragen. Werte: ? (zu prÃ¼fen), 0 (nicht geeignet), 1 (Bonus), 2 (PrÃ¼fung). Klicken zum Ã„ndern (Zyklus: ? â†’ 0 â†’ 1 â†’ 2 â†’ ?). Erscheint nur nach Anwendung des Bonus-Filters.</li>
              <li><strong>Bew. tot.:</strong> Finale Bewertung in % (automatisch + manuell). Dient als Grundlage fÃ¼r die Punkte pro Test.</li>
              <li><strong>Bew. aut.:</strong> Automatisch berechnete Bewertung basierend auf AktivitÃ¤ten (Frage erstellt, Bewertung der Frage, beantwortete Fragen).</li>
              <li><strong>Bew. man.:</strong> Manuelle Anpassung in % (z. B. +10 oder âˆ’5). Wird zur automatischen Bewertung addiert.</li>
              <li><strong>BegrÃ¼ndung:</strong> ErklÃ¤rung zu AbzÃ¼gen/Anpassungen. ZeilenumbrÃ¼che werden unterstÃ¼tzt; im Excel ist Umbruch aktiviert.</li>
              <li><strong>Fragen erstellt:</strong> Anzahl der erstellten Fragen (erwartet: 1). Werte ungleich 1 werden rot und fett dargestellt.</li>
              <li><strong>Erhaltene Bewertung:</strong> Durchschnittliche Sternebewertung der erstellten Frage(n). Werte < 4 werden rot markiert.</li>
              <li><strong>Î£ Komm.:</strong> Anzahl der Kommentare/Bewertungen zu der Frage.</li>
              <li><strong>Ã˜ Schw.:</strong> Durchschnittliche Schwierigkeit (0 = sehr einfach, 1 = sehr schwer).</li>
              <li><strong>Falscher Frageblock:</strong> â€YESâ€œ = Frage im falschen Themenblock (rot hervorgehoben).</li>
              <li><strong>Beantw./Bew. Fragen:</strong> Punkte fÃ¼r Antworten, mit Aufteilung: Gesamt (R: richtig / F: falsch).</li>
            </ul>
          </details>

          <details class="note">
            <summary>Hinweise zur Bewertung</summary>
            
            <h4>Automatische Bewertung (0-100%)</h4>
            <p>Gewichtete Gesamtbewertung aus drei Hauptaspekten plus zusÃ¤tzliche AbzÃ¼ge:</p>
            <ul>
              <li><strong>Frage erstellt (50%):</strong> 0 Fragen = 0%, 1 Frage = 100%, mehr als 1 Frage = 70%</li>
              <li><strong>Fragebewertung (25%):</strong> Basierend auf erhaltenen Sternen pro verÃ¶ffentlichter Frage, normalisiert auf Skala 2-5 (â‰¤2 Sterne = 0%, 5 Sterne = 100%, linear dazwischen)</li>
              <li><strong>Fragen beantwortet (25%):</strong> Basierend auf Anzahl beantworteter Fragen, normalisiert auf max. 5 Fragen (â‰¥5 Fragen = 100%)</li>
              <li><strong>Falscher Frageblock:</strong> -20% Abzug vom Gesamtergebnis, wenn Frage im falschen thematischen Block erstellt wurde</li>
              <li><strong>Falsche Antworten (progressiv):</strong> AbzÃ¼ge basierend auf VerhÃ¤ltnis von falschen zu richtigen Antworten:
                <ul style="margin-top: 5px; font-size: 0.95em;">
                  <li>Bei 0 richtigen: 0-2 falsch = 0%, 3 falsch = -10%, 4 falsch = -15%, â‰¥5 falsch = -20%</li>
                  <li>Bei 1-5 gesamt: 4F/1R = -10%, 3F/2R = -7.5%, 3F/1R = -5%, sonst 0%</li>
                  <li>Bei >5 gesamt: Abzug -10% nur wenn Falsch â‰¥ 2Ã— Richtig, sonst 0%</li>
                </ul>
              </li>
            </ul>
            <p><strong>Formel:</strong> (50% Ã— Bewertung_FrageErstellt + 25% Ã— Bewertung_FrageBewertung + 25% Ã— Bewertung_FragenBeantwortung) - ZusÃ¤tzliche AbzÃ¼ge</p>
            
            <h4>Automatische Markierung fÃ¼r manuelle Bewertung</h4>
            <p>Ein Eintrag wird automatisch als "Manuell zu bewerten" markiert (rot hervorgehoben), wenn eines der folgenden Kriterien zutrifft:</p>
            <ul>
              <li><strong>Mehr als eine Frage erstellt:</strong> Anzahl Fragen > 1 (ungewÃ¶hnlich, kÃ¶nnte auf Fehler hindeuten)</li>
              <li><strong>Punkte Sterne < 4:</strong> Niedrige Bewertung der erstellten Frage(n), deutet auf QualitÃ¤tsprobleme hin</li>
              <li><strong>Î£ Kommentare < 3:</strong> Zu wenige Bewertungen der Frage (< 3 Studierende), daher ist die Aussagekraft der Punkte Sterne nicht ausreichend. Die QualitÃ¤t der Frage muss manuell geprÃ¼ft werden</li>
              <li><strong>Falscher Frageblock:</strong> Frage wurde im falschen thematischen Block erstellt (Zuteilungsfehler)</li>
            </ul>
            <p><strong>Hinweis:</strong> AbzÃ¼ge fÃ¼r falsche Antworten erfolgen automatisch gemÃ¤ss obiger Formel und fÃ¼hren nicht zur Markierung fÃ¼r manuelle Bewertung.</p>
            <p><strong>Zweck:</strong> Diese Kriterien helfen dabei, Studierende zu identifizieren, die besondere Aufmerksamkeit benÃ¶tigen oder bei denen die automatische Bewertung mÃ¶glicherweise nicht angemessen ist.</p>
            
            <h4>Manuelle Bewertung</h4>
            <p>Nutzen Sie die Spalten <strong>â€Bew. man.â€œ</strong> (Anpassung in %, z.â€¯B. +10 oder âˆ’5) und <strong>â€BegrÃ¼ndungâ€œ</strong> (Text) zur fachlichen Korrektur. Setzen Sie manuelle Kommentare <em>unter</em> die automatischen BegrÃ¼ndungen, beginnen Sie mit einem Zeilenumbruch und einem Stern (<code>*</code>), z.â€¯B.:<br>â€<code>* Nach Sichtung der Frage QualitÃ¤t dennoch ausreichend</code>â€œ.</p>
          </details>
        </div>
      </details>

    </section>

    <section id="page-assign" class="page" aria-labelledby="tabAssign">
      <p class="hint">Studierenden-Themenzuteilung: Laden Sie eine Excel-Datei mit den Spalten <strong>Kuerzel</strong> und <strong>Klasse</strong> hoch, geben Sie die Testnummer und die BlÃ¶cke an und erzeugen Sie die Zuteilung.</p>

      <label for="studentsFile" class="label">Excel mit Studierenden (Kuerzel, Klasse)</label>
      <input id="studentsFile" type="file" accept=".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" />

      <label for="testNumber" class="label">Testnummer (1â€“12)</label>
      <input id="testNumber" type="number" min="1" max="12" placeholder="z. B. 3" />

      <label for="blocksInput" class="label">BlÃ¶cke (Semikolon-getrennt, Format: Semesterwoche_Folienbereich)</label>
      <input id="blocksInput" type="text" placeholder="z. B. 1_8-12; 1_13-17; 2_2-6" />

      <div class="buttons">
        <button id="btnTemplate" type="button" class="secondary">Template herunterladen</button>
        <button id="btnAssign" type="button" class="primary">Zuteilen & Vorschau</button>
        <button id="btnDownloadAssign" type="button" class="success">Als Excel herunterladen</button>
      </div>

      <div id="assignStatus" class="status" role="status" aria-live="polite"></div>

      <div id="assignSummary"></div>

      <div class="table-wrapper">
        <table id="assignPreviewTable">
          <thead>
            <tr>
              <th>KÃ¼rzel</th>
              <th>Klasse</th>
              <th>Frage erstellen in Block</th>
              <th>Fragen beantworten in BlÃ¶cken</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <details class="note">
        <summary>Hinweis zum BlÃ¶cke-Format</summary>
        <ul>
          <li>Format pro Block: <code>Semesterwoche_Folienbereich</code> (z. B. <code>1_8-12</code>).</li>
          <li>Mehrere BlÃ¶cke semikolongetrennt (z. B. <code>1_8-12; 1_13-17; 2_2-6</code>).</li>
          <li>Im Output werden Wochen zweistellig formatiert (z. B. <code>SW01F8-12</code>).</li>
        </ul>
      </details>
    </section>
  </div>
</body>
</html>
